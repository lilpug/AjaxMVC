/*!
    Title: AjaxMVC
    URL: https://github.com/lilpug/ajaxmvc
    Version: 1.1
    Author: David Whitehead
    Copyright (c) David Whitehead
    Copyright license: MIT
    Description: A plugin which sits on top of the ajax requests so we have a standard way of passing requests to aspnet 5+ mvc
                 with the anti forgery tokens etc.             
	Requires: jquery, bootstrap 3.3+
*/
!function(a){function b(b,c){var d=a(b).find("[name=__RequestVerificationToken]").val();return void 0!=d&&""!=d&&(void 0!=c&&null!=c?a.extend(c,{__RequestVerificationToken:d}):c={__RequestVerificationToken:d}),c}function c(b){var c=new FormData;return a.each(b,function(b,d){null==d||"string"==typeof d||"boolean"==typeof d||"number"==typeof d?c.append(b,d):a.each(d,function(a,d){c.append(b,d)})}),c}function d(b,c,d,e){var f=null;a(document).ajaxStart(function(){a("body").append(b),f=setTimeout(function(){a(c).attr("style","z-index: 20000000;"),a(c).modal("show")},d)}).ajaxStop(function(){clearTimeout(f),setTimeout(function(){a(document).on("hidden.bs.modal",c,function(){a(document).off("hidden.bs.modal",c),a(c+"-container").remove()}),a(c).modal("hide")},e),a(document).unbind("ajaxStart"),a(document).unbind("ajaxStop")})}function f(){return'<div id="ajax-processing-modal-container"><style>#ajax-processing-modal-container .modal-footer { border-top: none !important; } #ajax-processing-modal-container .modal { display: block !important; }  #ajax-processing-modal-container .modal-title h3{margin-top:5px;}#ajax-processing-modal-container .modal-title i{font-size:20px;}/* Extra Small Devices, Phones */ @media only screen and (max-width : 320px){#ajax-processing-modal-container .modal-body .notice{text-align: left !important;}}#ajax-processing-modal-container .modal-body .notice{padding-top:5px !important;}#ajax-processing-modal-container .modal-content{-webkit-border-radius: 0; -webkit-background-clip: padding-box; -moz-border-radius: 0; -moz-background-clip: padding; border-radius: 6px; background-clip: padding-box; -webkit-box-shadow: 0 0 40px rgba(0,0,0,.5); -moz-box-shadow: 0 0 40px rgba(0,0,0,.5); box-shadow: 0 0 40px rgba(0,0,0,.5); color: #000; background-color: #fff; border: rgba(0,0,0,0);}#ajax-processing-modal-container .modal-message .modal-header{margin-bottom: 10px; padding: 15px 0 8px; text-align: center!important;}#ajax-processing-modal-container .modal-message .modal-body, #ajax-processing-modal-container .modal-message .modal-footer, #ajax-processing-modal-container .modal-message .modal-title{padding: 0 20px; text-align: center!important;}#ajax-processing-modal-container .modal-message .modal-title{color: #737373; margin-bottom: 3px;}#ajax-processing-modal-container .modal-message .modal-body{color: #737373;}#ajax-processing-modal-container .modal-message .modal-header .fa, #ajax-processing-modal-container .modal-message .modal-header .glyphicon, .modal-message .modal-header .typcn, #ajax-processing-modal-container .modal-message .modal-header .wi{font-size: 30px;}#ajax-processing-modal-container .modal-body p{margin-top:5px;}#ajax-processing-modal-container .modal-message .modal-footer{margin-bottom:20px;}#ajax-processing-modal-container .modal-message.modal-info .modal-header{color: #57b5e3; border-bottom: 3px solid #57b5e3;}</style> <div id="ajax-processing-modal" class="modal modal-message modal-info fade" aria-hidden="true" data-backdrop="static" data-keyboard="false"> <div class="modal-dialog modal-md"> <div class="modal-content"> <div class="modal-header"> <i class="fa fa-pencil-square-o" aria-hidden="true"></i> </div><div class="modal-title"> <i class="fa fa-spin fa-spinner" aria-hidden="true"></i> <h3>Processing</h3> </div><div class="modal-body"> <p class="notice"><b>Processing your request please wait</b></p></div><div class="modal-footer"> </div></div></div></div></div>'}function g(){return'<div id="ajax-fileupload-modal-container"> <style>#ajax-fileupload-modal-container .modal-footer { border-top: none !important; } #ajax-fileupload-modal-container .modal-title h3{margin-top:5px;}#ajax-fileupload-modal-container .modal-title i{font-size:20px;}#ajax-fileupload-modal-container .status-info .left{text-align:left;}#ajax-fileupload-modal-container .status-info p{display:inline !important;}#ajax-fileupload-modal-container .status-info .right{text-align:right;}/* Small Devices, Tablets */ @media only screen and (max-width : 768px){#ajax-fileupload-modal-container .status-info .right{text-align:left !important;}}/* Extra Small Devices, Phones */ @media only screen and (max-width : 480px){#ajax-fileupload-modal-container .modal-body .notice{text-align: left !important;}}#ajax-fileupload-modal-container .progress-bar{background-image: none!important; background-color: #6CF06C !important;}#ajax-fileupload-modal-cancel{margin-bottom:15px; margin-top:10px; outline: none;}#ajax-fileupload-modal-container .modal-body .notice{padding-top:5px !important;}#ajax-fileupload-modal-container .modal-content{-webkit-border-radius: 0; -webkit-background-clip: padding-box; -moz-border-radius: 0; -moz-background-clip: padding; border-radius: 6px; background-clip: padding-box; -webkit-box-shadow: 0 0 40px rgba(0,0,0,.5); -moz-box-shadow: 0 0 40px rgba(0,0,0,.5); box-shadow: 0 0 40px rgba(0,0,0,.5); color: #000; background-color: #fff; border: rgba(0,0,0,0);}#ajax-fileupload-modal-container .modal-message .modal-header{margin-bottom: 10px; padding: 15px 0 8px; text-align: center!important;}#ajax-fileupload-modal-container .modal-message .modal-body, #ajax-fileupload-modal-container .modal-message .modal-footer, #ajax-fileupload-modal-container .modal-message .modal-title{padding: 0 20px; text-align: center!important;}#ajax-fileupload-modal-container .modal-message .modal-title{color: #737373; margin-bottom: 3px;}#ajax-fileupload-modal-container .modal-message .modal-body{color: #737373;}#ajax-fileupload-modal-container .modal-message .modal-header .fa, #ajax-fileupload-modal-container .modal-message .modal-header .glyphicon, .modal-message .modal-header .typcn, #ajax-fileupload-modal-container .modal-message .modal-header .wi{font-size: 30px;}#ajax-fileupload-modal-container .modal-body .progress, #ajax-fileupload-modal-container .modal-body p{margin-top:5px;}#ajax-fileupload-modal-container .modal-message .modal-footer{margin-bottom:20px;}#ajax-fileupload-modal-container .modal-message.modal-info .modal-header{color: #57b5e3; border-bottom: 3px solid #57b5e3;}</style> <div id="ajax-fileupload-modal" class="modal modal-message modal-info fade" style="display: block;" aria-hidden="true" data-backdrop="static" data-keyboard="false"> <div class="modal-dialog modal-md"> <div class="modal-content"> <div class="modal-header"> <i class="fa fa-file" aria-hidden="true"></i> </div><div class="modal-title"> <i class="fa fa-spin fa-spinner" aria-hidden="true"></i> <h3>Uploading Content</h3> </div><div class="modal-body"> <p class="notice"><b>Your content is uploading please wait until its completed</b></p><div class="row status-info"> <div class="col-sm-6 right"> <p></p>Total Size: </p><p class="total-size"></p></div><div class="col-sm-6 left"> <p>Currently At: </p><p class="currently-at"></p></div></div><div class="row"> <div class="col-sm-10 col-sm-offset-1"> <div class="progress"> <div class="progress-bar progress-bar-info progress-bar-striped" role="progressbar" style="width: 0%"> <span class="sr-only">0%</span> </div></div></div></div><button id="ajax-fileupload-modal-cancel" class="btn btn-danger">Cancel The Upload</button> </div><div class="modal-footer"> </div></div></div></div></div>'}function h(a){return!!(i()&&a[0].checkValidity()||!i())}function i(){return"function"==typeof document.createElement("input").checkValidity}a.fn.AjaxMVCFileUploadBlock=function(e,f,i,j,k,l){if(void 0==l||1==l&&h(this)||0==l){d(g(),"#ajax-fileupload-modal",1e3,1),e=b(this.selector,e);var m=a.ajax({type:f,url:j,timeout:864e5,xhr:function(){var b=a.ajaxSettings.xhr();return b.upload&&b.upload.addEventListener("progress",function(b){function c(a){if(0==a)return"0 Byte";var b=1024,c=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],d=Math.floor(Math.log(a)/Math.log(b));return(a/Math.pow(b,d)).toFixed(2)+" "+c[d]}if(b.lengthComputable&&a("#file-upload-dialog-box")){var d=b.total,e=b.loaded;a("#ajax-fileupload-modal-container .total-size").text(c(d)),a("#ajax-fileupload-modal-container .currently-at").text(c(e));var f=100*e/d;f>=100?(a("#ajax-fileupload-modal-container .progress-bar").css("width","100%"),a("#ajax-fileupload-modal-container .progress-bar").html("100%")):(a("#ajax-fileupload-modal-container .progress-bar").css("width",f+"%"),a("#ajax-fileupload-modal-container .progress-bar").html(Math.round(f)+"%"))}},!1),b},contentType:!1,processData:!1,dataType:i,data:null!=e.append?e:c(e)}).fail(function(a){}).done(function(b){if("json"==i){var c=a.parseJSON(b);k(c)}else k(b)});a(document).on("click","#ajax-fileupload-modal-cancel",function(){a("#ajax-fileupload-modal-container .modal-message .modal-header").attr("style","color: #d73d32 !important; border-bottom: 3px solid #e46f61 !important;"),a("#ajax-fileupload-modal-container .modal-body, #ajax-fileupload-modal-container .modal-title").attr("style","color: #d73d32 !important"),a("#ajax-fileupload-modal-container .modal-title h3").text("Stopping The Uploading"),a("#ajax-fileupload-modal-container .modal-body .notice").text("Stopping your content upload please wait"),m.abort(),a(document).off("click","#ajax-fileupload-modal-cancel")})}},a.fn.AjaxMVCFileUpload=function(d,f,g,i,j,k,l){if(void 0==k||1==k&&h(this)||0==k){d=b(this.selector,d);a.ajax({type:f,url:i,timeout:864e5,xhr:function(){var b=a.ajaxSettings.xhr();return b.upload&&b.upload.addEventListener("progress",l(e),!1),b},contentType:!1,processData:!1,dataType:g,data:null!=d.append?d:c(d)}).fail(function(a){}).done(function(b){if("json"==g){var c=a.parseJSON(b);j(c)}else j(b)})}},a.fn.AjaxFormDataMVC=function(e,g,i,j,k,l,m){if(void 0==l||1==l&&h(this)||0==l)return null!=m&&1==m&&d(f(),"#ajax-processing-modal",1e3,1),e=b(this.selector,e),a.ajax({type:g,url:j,contentType:!1,processData:!1,dataType:i,data:null!=e.append?e:c(e)}).done(function(b){if("json"==i){var c=a.parseJSON(b);k(c)}else k(b)})}}(jQuery);