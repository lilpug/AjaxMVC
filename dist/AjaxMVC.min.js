/*!
    Title: AjaxMVC
    URL: https://github.com/lilpug/ajaxmvc
    Version: 1.0
    Author: David Whitehead
    Copyright (c) David Whitehead
    Copyright license: MIT
    Description: A plugin which sits on top of the ajax requests so we have a standard way of passing requests to aspnet 5+ mvc
                 with the anti forgery tokens etc.             
	Requires: jquery, bootstrap 3.3+
*/
!function(a){function o(o,e){var d=a(o).find("[name=__RequestVerificationToken]").val();return void 0!=d&&""!=d&&(void 0!=e&&null!=e?a.extend(e,{__RequestVerificationToken:d}):e={__RequestVerificationToken:d}),e}function d(o){var e=new FormData;return a.each(o,function(o,d){null==d||"string"==typeof d||"boolean"==typeof d||"number"==typeof d?e.append(o,d):a.each(d,function(a,d){e.append(o,d)})}),e}function i(o,e,d,i){var l=null;a(document).ajaxStart(function(){l=setTimeout(function(){a("body").append(o),a(e).attr("style","z-index: 20000000;"),a(e).modal("show")},d)}).ajaxStop(function(){clearTimeout(l),setTimeout(function(){a(document).on("hidden.bs.modal",e,function(){a(document).off("hidden.bs.modal",e),a(e+"-container").remove()}),a(e).modal("hide")},i),a(document).unbind("ajaxStart"),a(document).unbind("ajaxStop")})}function l(){return'<div id="ajax-processing-modal-container"><style>.modal { display: none !important; } #ajax-processing-modal-container .modal { display: block !important; }  #ajax-processing-modal-container .modal-title h3{margin-top:5px;}#ajax-processing-modal-container .modal-title i{font-size:20px;}/* Extra Small Devices, Phones */ @media only screen and (max-width : 320px){#ajax-processing-modal-container .modal-body .notice{text-align: left !important;}}#ajax-processing-modal-container .modal-body .notice{padding-top:5px !important;}#ajax-processing-modal-container .modal-content{-webkit-border-radius: 0; -webkit-background-clip: padding-box; -moz-border-radius: 0; -moz-background-clip: padding; border-radius: 6px; background-clip: padding-box; -webkit-box-shadow: 0 0 40px rgba(0,0,0,.5); -moz-box-shadow: 0 0 40px rgba(0,0,0,.5); box-shadow: 0 0 40px rgba(0,0,0,.5); color: #000; background-color: #fff; border: rgba(0,0,0,0);}#ajax-processing-modal-container .modal-message .modal-header{margin-bottom: 10px; padding: 15px 0 8px; text-align: center!important;}#ajax-processing-modal-container .modal-message .modal-body, #ajax-processing-modal-container .modal-message .modal-footer, #ajax-processing-modal-container .modal-message .modal-title{padding: 0 20px; text-align: center!important;}#ajax-processing-modal-container .modal-message .modal-title{color: #737373; margin-bottom: 3px;}#ajax-processing-modal-container .modal-message .modal-body{color: #737373;}#ajax-processing-modal-container .modal-message .modal-header .fa, #ajax-processing-modal-container .modal-message .modal-header .glyphicon, .modal-message .modal-header .typcn, #ajax-processing-modal-container .modal-message .modal-header .wi{font-size: 30px;}#ajax-processing-modal-container .modal-body p{margin-top:5px;}#ajax-processing-modal-container .modal-message .modal-footer{margin-bottom:20px;}#ajax-processing-modal-container .modal-message.modal-info .modal-header{color: #57b5e3; border-bottom: 3px solid #57b5e3;}</style> <div id="ajax-processing-modal" class="modal modal-message modal-info fade in" aria-hidden="true" data-backdrop="static" data-keyboard="false"> <div class="modal-dialog modal-md"> <div class="modal-content"> <div class="modal-header"> <i class="fa fa-pencil-square-o" aria-hidden="true"></i> </div><div class="modal-title"> <i class="fa fa-spin fa-spinner" aria-hidden="true"></i> <h3>Processing</h3> </div><div class="modal-body"> <p class="notice"><b>Processing your request please wait</b></p></div><div class="modal-footer"> </div></div></div></div></div>'}function n(){return'<div id="ajax-fileupload-modal-container"> <style>#ajax-fileupload-modal-container .modal-title h3{margin-top:5px;}#ajax-fileupload-modal-container .modal-title i{font-size:20px;}#ajax-fileupload-modal-container .status-info .left{text-align:left;}#ajax-fileupload-modal-container .status-info p{display:inline !important;}#ajax-fileupload-modal-container .status-info .right{text-align:right;}/* Small Devices, Tablets */ @media only screen and (max-width : 768px){#ajax-fileupload-modal-container .status-info .right{text-align:left !important;}}/* Extra Small Devices, Phones */ @media only screen and (max-width : 480px){#ajax-fileupload-modal-container .modal-body .notice{text-align: left !important;}}#ajax-fileupload-modal-container .progress-bar{background-image: none!important; background-color: #6CF06C !important;}#ajax-fileupload-modal-cancel{margin-bottom:15px; margin-top:10px; outline: none;}#ajax-fileupload-modal-container .modal-body .notice{padding-top:5px !important;}#ajax-fileupload-modal-container .modal-content{-webkit-border-radius: 0; -webkit-background-clip: padding-box; -moz-border-radius: 0; -moz-background-clip: padding; border-radius: 6px; background-clip: padding-box; -webkit-box-shadow: 0 0 40px rgba(0,0,0,.5); -moz-box-shadow: 0 0 40px rgba(0,0,0,.5); box-shadow: 0 0 40px rgba(0,0,0,.5); color: #000; background-color: #fff; border: rgba(0,0,0,0);}#ajax-fileupload-modal-container .modal-message .modal-header{margin-bottom: 10px; padding: 15px 0 8px; text-align: center!important;}#ajax-fileupload-modal-container .modal-message .modal-body, #ajax-fileupload-modal-container .modal-message .modal-footer, #ajax-fileupload-modal-container .modal-message .modal-title{padding: 0 20px; text-align: center!important;}#ajax-fileupload-modal-container .modal-message .modal-title{color: #737373; margin-bottom: 3px;}#ajax-fileupload-modal-container .modal-message .modal-body{color: #737373;}#ajax-fileupload-modal-container .modal-message .modal-header .fa, #ajax-fileupload-modal-container .modal-message .modal-header .glyphicon, .modal-message .modal-header .typcn, #ajax-fileupload-modal-container .modal-message .modal-header .wi{font-size: 30px;}#ajax-fileupload-modal-container .modal-body .progress, #ajax-fileupload-modal-container .modal-body p{margin-top:5px;}#ajax-fileupload-modal-container .modal-message .modal-footer{margin-bottom:20px;}#ajax-fileupload-modal-container .modal-message.modal-info .modal-header{color: #57b5e3; border-bottom: 3px solid #57b5e3;}</style> <div id="ajax-fileupload-modal" class="modal modal-message modal-info fade in" style="display: block;" aria-hidden="true" data-backdrop="static" data-keyboard="false"> <div class="modal-dialog modal-md"> <div class="modal-content"> <div class="modal-header"> <i class="fa fa-file" aria-hidden="true"></i> </div><div class="modal-title"> <i class="fa fa-spin fa-spinner" aria-hidden="true"></i> <h3>Uploading Content</h3> </div><div class="modal-body"> <p class="notice"><b>Your content is uploading please wait until its completed</b></p><div class="row status-info"> <div class="col-sm-6 right"> <p></p>Total Size: </p><p class="total-size"></p></div><div class="col-sm-6 left"> <p>Currently At: </p><p class="currently-at"></p></div></div><div class="row"> <div class="col-sm-10 col-sm-offset-1"> <div class="progress"> <div class="progress-bar progress-bar-info progress-bar-striped" role="progressbar" style="width: 0%"> <span class="sr-only">0%</span> </div></div></div></div><button id="ajax-fileupload-modal-cancel" class="btn btn-danger">Cancel The Upload</button> </div><div class="modal-footer"> </div></div></div></div></div>'}function t(a){return r()&&a[0].checkValidity()||!r()?!0:!1}function r(){return"function"==typeof document.createElement("input").checkValidity}a.fn.AjaxMVCFileUploadBlock=function(e,l,r,s,m,c){if(void 0==c||1==c&&t(this)||0==c){i(n(),"#ajax-fileupload-modal",1e3,3e3),e=o(this.selector,e);var p=a.ajax({type:l,url:s,timeout:864e5,xhr:function(){var o=a.ajaxSettings.xhr();return o.upload&&o.upload.addEventListener("progress",function(o){function e(a){if(0==a)return"0 Byte";var o=1024,e=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],d=Math.floor(Math.log(a)/Math.log(o));return(a/Math.pow(o,d)).toFixed(2)+" "+e[d]}if(o.lengthComputable&&a("#file-upload-dialog-box")){var d=o.total,i=o.loaded;a("#ajax-fileupload-modal-container .total-size").text(e(d)),a("#ajax-fileupload-modal-container .currently-at").text(e(i));var l=100*i/d;l>=100?(a("#ajax-fileupload-modal-container .progress-bar").css("width","100%"),a("#ajax-fileupload-modal-container .progress-bar").html("100%")):(a("#ajax-fileupload-modal-container .progress-bar").css("width",l+"%"),a("#ajax-fileupload-modal-container .progress-bar").html(Math.round(l)+"%"))}},!1),o},contentType:!1,processData:!1,dataType:r,data:null!=e.append?e:d(e)}).fail(function(a){}).done(function(o){if("json"==r){var e=a.parseJSON(o);m(e)}else m(o)});a(document).on("click","#ajax-fileupload-modal-cancel",function(){a("#ajax-fileupload-modal-container .modal-message .modal-header").attr("style","color: #d73d32 !important; border-bottom: 3px solid #e46f61 !important;"),a("#ajax-fileupload-modal-container .modal-body, #ajax-fileupload-modal-container .modal-title").attr("style","color: #d73d32 !important"),a("#ajax-fileupload-modal-container .modal-title h3").text("Stopping The Uploading"),a("#ajax-fileupload-modal-container .modal-body .notice").text("Stopping your content upload please wait"),p.abort(),a(document).off("click","#ajax-fileupload-modal-cancel")})}},a.fn.AjaxMVCFileUpload=function(i,l,n,r,s,m,c){if(void 0==m||1==m&&t(this)||0==m){i=o(this.selector,i);a.ajax({type:l,url:r,timeout:864e5,xhr:function(){var o=a.ajaxSettings.xhr();return o.upload&&o.upload.addEventListener("progress",c(e),!1),o},contentType:!1,processData:!1,dataType:n,data:null!=i.append?i:d(i)}).fail(function(a){}).done(function(o){if("json"==n){var e=a.parseJSON(o);s(e)}else s(o)})}},a.fn.AjaxFormDataMVC=function(e,n,r,s,m,c,p){return void 0==c||1==c&&t(this)||0==c?(null!=p&&1==p&&i(l(),"#ajax-processing-modal",1e3,1),e=o(this.selector,e),a.ajax({type:n,url:s,contentType:!1,processData:!1,dataType:r,data:null!=e.append?e:d(e)}).done(function(o){if("json"==r){var e=a.parseJSON(o);m(e)}else m(o)})):void 0}}(jQuery);